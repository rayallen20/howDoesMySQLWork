# 6. 让索引列以列名的形式在搜索条件中单独出现

在下面这两个查询语句中,搜索条件的语义是一样的:

```sql
SELECT * 
FROM single_table 
WHERE key2 * 2 < 4;
```

```sql
SELECT * 
FROM single_table 
WHERE key2 < 4 / 2;
```

在第1个查询语句的搜索条件中,`key2`列并不是以单独列名的形式出现的,而是以`key2 * 2`这样的**表达式**的形式出现的.
MySQL并不会尝试简化表达式`key2 * 2 < 4`,而是直接认为这个搜索条件不能形成合适的扫描区间来减少需要扫描的记录数量,
(也就是说MySQL只能全表扫描,检查每一条记录的`key2 * 2`是否小于4),所以该查询语句只能以全表扫描的方式来执行.该查询语句的执行计划如下:

```
mysql> DESC SELECT * 
    -> FROM single_table 
    -> WHERE key2 * 2 < 4;
+----+-------------+--------------+------------+------+---------------+------+---------+------+-------+----------+-------------+
| id | select_type | table        | partitions | type | possible_keys | key  | key_len | ref  | rows  | filtered | Extra       |
+----+-------------+--------------+------------+------+---------------+------+---------+------+-------+----------+-------------+
|  1 | SIMPLE      | single_table | NULL       | ALL  | NULL          | NULL | NULL    | NULL | 10200 |   100.00 | Using where |
+----+-------------+--------------+------------+------+---------------+------+---------+------+-------+----------+-------------+
1 row in set, 1 warning (0.00 sec)
```

在第二个查询语句的搜索条件中,`key2`列是以单独列名的形式出现的,MySQL可以分析出:
如果使用唯一二级索引`uk_key2`执行査询,对应的扫描区间为`key2 ∈ (-∞,2)`,这可以减少需要扫描的记录数量.该查询语句的执行计划如下:

```
mysql> DESC SELECT * 
    -> FROM single_table 
    -> WHERE key2 < 4 / 2;
+----+-------------+--------------+------------+-------+---------------+---------+---------+------+------+----------+-----------------------+
| id | select_type | table        | partitions | type  | possible_keys | key     | key_len | ref  | rows | filtered | Extra                 |
+----+-------------+--------------+------------+-------+---------------+---------+---------+------+------+----------+-----------------------+
|  1 | SIMPLE      | single_table | NULL       | range | uk_key2       | uk_key2 | 5       | NULL |    1 |   100.00 | Using index condition |
+----+-------------+--------------+------------+-------+---------------+---------+---------+------+------+----------+-----------------------+
1 row in set, 1 warning (0.00 sec)
```

所以,如果想让某个查询使用索引来执行,请让索引列以列名的形式单独出现在搜索条件中.
