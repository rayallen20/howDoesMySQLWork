# 5. SUBQUERY

SUBQUERY在文档中的描述为: First SELECT in subquery

若:

- 包含子查询的查询语句不能转为对应的半连接形式
- 且该子查询是不相关子查询
- **且查询优化器决定采用将该子查询物化的方案来执行该子查询**

时,则该子查询的第1个`SELECT`关键字代表的那个查询的`select_type`值为SUBQUERY

例如:

```
mysql> EXPLAIN SELECT * FROM single_table WHERE key1 IN (SELECT key1 FROM single_table2) OR key3 = 'a';
+----+-------------+---------------+------------+-------+---------------+----------+---------+------+------+----------+-------------+
| id | select_type | table         | partitions | type  | possible_keys | key      | key_len | ref  | rows | filtered | Extra       |
+----+-------------+---------------+------------+-------+---------------+----------+---------+------+------+----------+-------------+
|  1 | PRIMARY     | single_table  | NULL       | ALL   | idx_key3      | NULL     | NULL    | NULL | 9817 |   100.00 | Using where |
|  2 | SUBQUERY    | single_table2 | NULL       | index | idx_key1      | idx_key1 | 403     | NULL | 9942 |   100.00 | Using index |
+----+-------------+---------------+------------+-------+---------------+----------+---------+------+------+----------+-------------+
2 rows in set, 1 warning (0.01 sec)
```

可以看到,外层查询的`select_type`值为PRIMARY,子查询的`select_type`值为SUBQUERY.

注意: **由于`select_type`为SUBQUERY的子查询由于会被物化,所以该子查询只需执行1遍**
