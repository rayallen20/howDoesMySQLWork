# 1. 问题的产生

InnoDB的设计者认为:**向某个索引对应的B+树中插入1条记录的过程必须是原子的,不能说插了一半之后就停止了**.比如,在悲观插入的过程中:

- 新的页面已经分配好了
- 数据也迁移到新页面中了
- 新的记录也插入到对应页面中了

但是没有完成在非叶节点中插入1条目录项记录这个步骤(可能因为系统崩溃/服务器宕机等原因).那么,**这个插入过程就是不完整的,这就会形成一棵不正确的B+树**.

`redo`日志是为了在系统因崩溃而重启时,恢复崩溃前的状态而提出的.若在悲观插入的过程中只记录了一部分`redo`日志,则在系统重启(这里的重启是指因崩溃而重启)后,
会将索引对应的B+树恢复成一种不正确的状态.这是InnoDB的设计者不能接受的.所以他们规定:**在执行这些需要保证原子性的操作时,
必须以组的形式来记录的`redo`日志**.在重启后进行恢复时,针对某个组中的`redo`日志:

- 要么把全部的日志都恢复
- 要么一条也不恢复

如何实现呢?这需要分情况讨论.
