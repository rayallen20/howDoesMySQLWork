# 6. 各级别字符集和比较规则小结

- 若创建或修改列时,没有显式指定字符集和比较规则,则该列默认使用所在表的字符集和比较规则
- 若创建或修改表时,没有显式指定字符集和比较规则,则该表默认使用所在数据库的字符集和比较规则
- 若创建或修改数据库时没有显式的指定字符集和比较规则,则该数据库默认用服务器的字符集和比较规则

知道了这些规则后,对于给定的表,就应该在知道该表中各个列的字符集和比较规则是什么,从而根据每个列的类型来确定存储数据时每个列的实际数据占用的存储空间大小.

例:

- 插入数据:

```
mysql> INSERT INTO t(col) VALUES('我我');
Query OK, 1 row affected (0.02 sec)
```

- 查询全表:

```
mysql> SELECT * FROM t;
+--------+
| col    |
+--------+
| 我我   |
+--------+
1 row in set (0.00 sec)
```

- 查看表的创建语句:

```
mysql> SHOW CREATE TABLE t;
+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table | Create Table                                                                                                                                                          |
+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| t     | CREATE TABLE `t` (
  `col` varchar(50) CHARACTER SET gb2312 COLLATE gb2312_chinese_ci DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci |
+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.01 sec)
```

- 推断大小:
  - 表中只有1行数据
  - 该行只有1列,该列的字符集为`gb2312`,存储的是2个汉字(汉字不在`ascii`字符集范围内,因此每个汉字占用2个字节),因此该列的实际数据占用的存储空间大小为`2 * 2 = 4`字节