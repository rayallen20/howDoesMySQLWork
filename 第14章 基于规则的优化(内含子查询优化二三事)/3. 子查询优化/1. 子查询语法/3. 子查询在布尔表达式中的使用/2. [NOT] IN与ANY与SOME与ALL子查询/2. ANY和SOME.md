# 2. ANY和SOME

- ANY操作符: 主要用于子查询比较,表示**和子查询返回的某个值(至少1个值)进行比较**
  - 若和子查询结果集中的任意一个值比较结果为TRUE,则整个比较条件的结果为TRUE
- SOME操作符: 与ANY相同,SOME是ANY的同义词

`ANY`/`SOME`与子查询组成的布尔表达式的格式如下:

```
操作数 comparison_operator ANY/SOME(子查询)
```

假设子查询返回一个值列表: `[v1, v2, v3, ...]`,则`操作数 comparison_operator ANY/SOME(子查询)`等价于:

```
(操作数 comparison_operator v1) OR (操作数 comparison_operator v2) OR (操作数 comparison_operator v3) ...
```

只要有1个比较结果为TRUE,则整个表达式就为TRUE.

例如: 

```
mysql> SELECT *
    -> FROM t1
    -> WHERE m1 > ANY (
    ->     SELECT m2
    ->     FROM t2
    -> );
+------+------+
| m1   | n1   |
+------+------+
|    3 | c    |
+------+------+
1 row in set (0.00 sec)
```

该查询的含义为: 对于`t1`表的每条记录的`m1`列的值来说,若子查询`(SELECT m2 FROM t2)`的结果集中,
存在至少1个小于`m1`列的值,则整个布尔表达式`m1 > ANY (SELECT m2 FROM t2)`的值即为TRUE(即该条数据会出现在结果集中),
否则为FALSE(即该条数据不会出现在结果集中).
也就是说只要`m1`列的值大于子查询结果集中最小的值,整个表达式的结果就是TRUE.所以该查询本质上等价于:

```
mysql> SELECT *
    -> FROM t1
    -> WHERE m1 > (
    ->     SELECT MIN(m2)
    ->     FROM t2
    -> );
+------+------+
| m1   | n1   |
+------+------+
|    3 | c    |
+------+------+
1 row in set (0.00 sec)
```

- `=ANY`: 判断某个表达式的值是否等于子查询返回的"任意一个值"
  - 若等于其中至少1个值,则返回TRUE;否则返回FALSE
  - 含义和IN操作符相同,可以使用IN操作符代替

假设子查询返回一个值列表: `[v1, v2, v3, ...]`,则`操作数 =ANY/=SOME(子查询)`等价于:

```
(操作数 = v1) OR (操作数 = v2) OR (操作数 = v3) ...
```

```
mysql> SELECT *
    -> FROM t1
    -> WHERE m1 = ANY(
    ->     SELECT m2
    ->     FROM t2
    -> );
+------+------+
| m1   | n1   |
+------+------+
|    2 | b    |
|    3 | c    |
+------+------+
2 rows in set (0.00 sec)
```
