# 6. 隐式提交

当使用`START TRANSACTION`或者`BEGIN`语句开启了一个事务,或者把系统变量`autocommit`的值设置为`OFF`后,事务就不会进行自动提交.
但是如果输入了某些语句,且这些语句会导致之前的事务悄悄的提交掉(就像输入了`COMMIT`语句了一样),那么这种**因为某些特殊的语句而导致事务提交的情况称为隐式提交**.
会导致事务隐式提交的语句包括:

- 定义或修改数据库对象的数据定义语言(Data Definition Language,DDL)

    数据库对象,即: 
    
    - 数据库
    - 表
    - 视图
    - 存储过程
    - 等等
    
    当使用:
    
    - `CREATE`
    - `ALTER`
    - `DROP`
    
    等语句去修改这些数据库对象时,就会隐式地提交前面语句所属的事务.例如:
    
    ```
    BEGIN;
    SELECT ... # 事务中的一条语句
    UPDATE ... # 事务中的一条语句
    ... # 事务中的其它语句
    CREATE TABLE ... # 此语句会隐式提交前面语句所属的事务
    ```

- 隐式使用或修改`mysql`数据库中的表

    当使用:

    - `ALTER USER`
    - `CREATE USER`
    - `DROP USER`
    - `GRANT`
    - `RENAME USER`
    - `REVOKE`
    - `SET PASSWORD`
    - 等语句

    时,也会隐式第提交前面语句所属的事务.

- 事务控制或关于锁定的语句

    当在一个事务还没提交或者还没回滚时,又使用`START TRANSACTION`或`BEGIN`语句开启了另一个事务,此时会隐式地提交上一个事务.例如:

    ```
    BEGIN;
    SELECT ... # 事务中的一条语句
    UPDATE ... # 事务中的一条语句
    ... # 事务中的其它语句
    BEGIN; # 此语句会隐式提交前面语句所属的事务
    ```

    在当前的`autocommit`系统变量的值为`OFF`,手动把它调为`ON`时,也会隐式地提交前面语句所属的事务.

    使用:

    - `LOCK TABLES`
    - `UNLOCK TABLES`
    - 等

    关于锁定的语句,也会隐式地提交前面语句所属的事务.

- 加载数据的语句

    使用`LOAD DATA`语句向数据库中批量导入数据时,也会隐式地提交前边语句所属的事务

- 关于MySQL复制的一些语句

    使用:
    
    - `START SLAVE`
    - `STOP SLAVE`
    - `RESET SLAVE`
    - `CHANGE MASTER TO`
    - 等
    
    语句时,也会隐式地提交前面语句所属的事务

- 其他语句

使用:

- `ANALYZE TABLE`
- `CACHE INDEX`
- `CHECK TABLE`
- `FLUSH`
- `LOAD INDEX INTO CACHE`
- `OPTIMIZE TABLE`
- `REPAIR TABLE`
- `RESET`
- 等

语句时,也会隐式地提交前面语句所属的事务.
